# Programmatic Vulnerability Remediation — Windows Lab

**Quick warning:** Do **NOT** use weak credentials (e.g., `labuser/Cyberlab123!`). If you enable weak configs or accounts, **shut down or destroy the VM** when finished. Run remediation scripts as soon as practical.

---

## Lab outline (steps)

1. **Provision a Windows Server VM**
   - Note OS & version.
   - Do not use easy passwords.

2. **Prepare VM for authenticated scanning (run AS ADMIN on VM)**
   - Enable remote local admin token:
     ```powershell
     Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "LocalAccountTokenFilterPolicy" -Value 1 -Type DWord -Force
     ```
   - (Run in an elevated PowerShell window.)

3. **Disable Windows Firewall**
   ```powershell
   # Run as admin
   Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled False
Create vulnerabilities (examples)

Install insecure/old software (e.g. old Wireshark installer).

Disable Windows Update.

Add built-in Guest account to Administrators.

Enable insecure cipher suites (for testing).

Install any other intentionally vulnerable tools.

After creating vulnerabilities: restart the server once.

Create an AUTHENTICATED Tenable scan (Windows template)

Scanner Type: Internal Scanner (or Tenable Cloud with public IP + open NSG).

Use valid credentials and confirm the scan authenticates.

Scan & export

Run the scan.

Verify credentials worked.

Export and save results (filter out "info" level if desired).
[![Final Scan Screenshot](https://github.com/naeemanderson/soc-internship/blob/main/Implementing%20a%20Vulnerability%20Programfnal%20final%20scan1.png)](https://github.com/naeemanderson/soc-internship/blob/main/Implementing%20a%20Vulnerability%20Programfnal%20final%20scan1.png)

Keep exports local and do not commit them to Git.

When finished for the day

Turn VM off (do not delete until final project).

If you’ve enabled dangerous settings (weak root, Guest as admin) run remediation immediately.

Remediation scripts
remediate-windows.ps1 — global remediation (resets token policy, re-enables firewall & update, removes Guest from Administrators, disables weak ciphers)

remove-insecure-software.ps1 — uninstall old/insecure software (sample)

restore-windows-update-firewall.ps1 — re-enable Windows Update & firewall

Always run scripts in an elevated PowerShell (Run as Administrator).

