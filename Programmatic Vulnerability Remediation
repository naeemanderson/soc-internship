# Windows 10 Vulnerability Management Lab

This lab demonstrates provisioning a Windows 10 VM, introducing common misconfigurations/vulnerabilities, scanning with Tenable, and remediating issues with PowerShell automation.

---

## Steps

### 1. Provision Windows 10 VM
- Deploy a Windows 10 VM in Azure.
- Turn **Windows Firewall Off** for lab purposes.

---

### 2. Enable Remote Administrative Access
Run the following **PowerShell as Administrator** on the VM:

```powershell
Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" `
-Name "LocalAccountTokenFilterPolicy" -Value 1 -Type DWord -Force
3. Configure Tenable Scan
Create an Authenticated Scan in Tenable using the Windows 10 DISA STIG Template.

Scanner Type: Internal Scanner (or Cloud Scanner if Internal is offline).

Use the VMâ€™s public IP if Cloud Scanner.

Run the scan, confirm credentials work, and export results.

4. Introduce Vulnerabilities
Inside the VM:

Install an old version of Firefox

Enable SMBv1

Enable discouraged protocols (SSL 2.0, SSL 3.0, TLS 1.0, TLS 1.1)

Scripts provided in vuln-scripts/.

Restart the VM.

5. Run Scan Again
Run the authenticated scan again.

Observe vulnerabilities:

Outdated Firefox

SMBv1 Enabled

Weak SSL/TLS protocols

6. Remediation
Download scripts into C:\Users\<username>\Desktop\ and run:

powershell
Copy code
powershell -ExecutionPolicy Bypass -File "C:\Users\<username>\Desktop\remediation-FireFox-uninstall.ps1"
powershell -ExecutionPolicy Bypass -File "C:\Users\<username>\Desktop\remediation-SMBv1.ps1"
powershell -ExecutionPolicy Bypass -File "C:\Users\<username>\Desktop\toggle-win10-protocols.ps1"
Or run all at once with remediation.bat.

Restart the VM.

7. Post-Remediation Scan
Run authenticated scan again in Tenable.

Export results.

Compare pre-remediation vs post-remediation results.

8. Cleanup
Delete your Azure VM when finished.
 
